{"ast":null,"code":"import _regeneratorRuntime from\"/home/trinh/Documents/code/mss-showme/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/trinh/Documents/code/mss-showme/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/home/trinh/Documents/code/mss-showme/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"/home/trinh/Documents/code/mss-showme/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/trinh/Documents/code/mss-showme/node_modules/@babel/runtime/helpers/esm/createClass.js\";import axios from'axios';import _ from'lodash';import Config from'../config';import{localStorage}from'../utils';import Cookies from'js-cookie';export var Api=/*#__PURE__*/function(){function Api(instance,getDefaultHeader){_classCallCheck(this,Api);this.instance=void 0;if(instance){this.instance=instance;this.getDefaultHeader=getDefaultHeader;}else{this.instance=axios.create({baseURL:'http://172.16.9.47:8989'});}}_createClass(Api,[{key:\"getDefaultHeader\",value:function getDefaultHeader(){return{'content-type':'application/json'};}},{key:\"getDefaultOptions\",value:function getDefaultOptions(){var isAuth=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return{headers:_objectSpread({},typeof this.getDefaultHeader==='function'?this.getDefaultHeader():{})};}},{key:\"attachToken\",value:function attachToken(){var payload=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var token=Cookies.get('_token');var sessionId=localStorage.getItem('sessionId');return _objectSpread(_objectSpread({},payload),{},{Token:token,SessionId:sessionId});}},{key:\"handleError\",value:function handleError(error){if(error.response&&error.response.status===401){Cookies.remove('_token');window.location.href=Config.SIGN_IN_URL+'?url_new_insight='+window.location.href.replaceAll('&',\"and\");}}},{key:\"createPromise\",value:function(){var _createPromise=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(response){var _this=this;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",new Promise(function(resolve,reject){response.then(function(result){resolve(result);},function(error){_this.handleError(error);reject(error);});}));case 1:case\"end\":return _context.stop();}},_callee);}));function createPromise(_x){return _createPromise.apply(this,arguments);}return createPromise;}()},{key:\"fetch\",value:function fetch(url){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return this.createPromise(this.get(url,options,false));}},{key:\"get\",value:function get(url){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var isAuth=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var finalOptions=_.merge(this.getDefaultOptions(isAuth),options);return this.createPromise(this.instance.get(url,finalOptions));}},{key:\"put\",value:function put(url){var payload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var isAuth=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var finalOptions=_.merge(this.getDefaultOptions(isAuth),options);var finalPayload=this.attachToken(payload);return this.createPromise(this.instance.put(url,finalPayload,finalOptions));}},{key:\"post\",value:function post(url){var payload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var isAuth=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var finalOptions=_.merge(this.getDefaultOptions(isAuth),options);var finalPayload=this.attachToken(payload);return this.createPromise(this.instance.post(url,finalPayload,finalOptions));}},{key:\"delete\",value:function _delete(url){var payload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var isAuth=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;var finalOptions=_.merge(this.getDefaultOptions(isAuth),options);var finalPayload=this.attachToken(payload);if(finalPayload){finalOptions.data=finalPayload;}return this.createPromise(this.instance.request(_objectSpread({method:'DELETE',url:url},finalOptions)));}}]);return Api;}();export default new Api();","map":{"version":3,"names":["axios","_","Config","localStorage","Cookies","Api","instance","getDefaultHeader","_classCallCheck","create","baseURL","_createClass","key","value","getDefaultOptions","isAuth","arguments","length","undefined","headers","_objectSpread","attachToken","payload","token","get","sessionId","getItem","Token","SessionId","handleError","error","response","status","remove","window","location","href","SIGN_IN_URL","replaceAll","_createPromise","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this","wrap","_callee$","_context","prev","next","abrupt","Promise","resolve","reject","then","result","stop","createPromise","_x","apply","fetch","url","options","finalOptions","merge","put","finalPayload","post","_delete","data","request","method"],"sources":["/home/trinh/Documents/code/mss-showme/src/app/utils/api.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosRequestConfig, AxiosError, AxiosResponse } from 'axios';\nimport _ from 'lodash';\nimport Config from '../config';\nimport { localStorage } from '../utils';\nimport { Object } from '../types';\nimport Cookies from 'js-cookie';\n\ntype optionsType = object | undefined | null;\n\nexport class Api {\n  instance: AxiosInstance;\n  getDefaultHeader?(): Object<any> {\n    return { 'content-type': 'application/json' };\n  }\n\n  constructor(instance?: AxiosInstance, getDefaultHeader?: () => Object<any>) {\n    if (instance) {\n      this.instance = instance;\n      this.getDefaultHeader = getDefaultHeader;\n    } else {\n      this.instance = axios.create({\n        baseURL: 'http://172.16.9.47:8989',\n      });\n    }\n  }\n\n  getDefaultOptions(isAuth = true) {\n    return {\n      headers: {\n        ...(typeof this.getDefaultHeader === 'function' ? this.getDefaultHeader() : {}),\n        // ...auth,\n      },\n    };\n  }\n\n  attachToken(payload: any = {}) {\n    const token = Cookies.get('_token');\n    const sessionId = localStorage.getItem('sessionId');\n    return {\n      ...payload,\n      Token: token,\n      SessionId: sessionId,\n    };\n  }\n\n  handleError(error: AxiosError) {\n    if (error.response && error.response.status === 401) {\n      Cookies.remove('_token');\n      window.location.href = Config.SIGN_IN_URL + '?url_new_insight=' + window.location.href.replaceAll('&', \"and\");\n    }\n  }\n\n  async createPromise(response: Promise<AxiosResponse>): Promise<AxiosResponse> {\n    return new Promise((resolve, reject) => {\n      response.then(\n        (result: any) => {\n          resolve(result);\n        },\n        error => {\n          this.handleError(error);\n          reject(error);\n        }\n      );\n    });\n  }\n\n  fetch(url: string, options = {}) {\n    return this.createPromise(this.get(url, options, false));\n  }\n\n  get(url: string, options: any = {}, isAuth = true): Promise<AxiosResponse> {\n    const finalOptions = _.merge(this.getDefaultOptions(isAuth), options);\n    return this.createPromise(this.instance.get(url, finalOptions));\n  }\n\n  put(url: string, payload: any = null, options: any = {}, isAuth = true): Promise<AxiosResponse> {\n    const finalOptions = _.merge(this.getDefaultOptions(isAuth), options);\n    const finalPayload = this.attachToken(payload);\n    return this.createPromise(this.instance.put(url, finalPayload, finalOptions));\n  }\n\n  post(url: string, payload: any = null, options: optionsType = {}, isAuth = true): Promise<AxiosResponse> {\n    const finalOptions = _.merge(this.getDefaultOptions(isAuth), options);\n    const finalPayload = this.attachToken(payload);\n    return this.createPromise(this.instance.post(url, finalPayload, finalOptions));\n  }\n\n  delete(url: string, payload: any = null, options: any = {}, isAuth = true): Promise<AxiosResponse> {\n    const finalOptions: AxiosRequestConfig = _.merge(this.getDefaultOptions(isAuth), options);\n    const finalPayload = this.attachToken(payload);\n\n    if (finalPayload) {\n      finalOptions.data = finalPayload;\n    }\n\n    return this.createPromise(this.instance.request({ method: 'DELETE', url, ...finalOptions }));\n  }\n}\n\nexport default new Api();\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}