{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { deepMix, isString, substitute } from '@antv/util';\nimport { modifyCSS } from '@antv/dom-util';\nimport DomStyles from './theme';\nimport { CONTAINER_CLASS, CONTAINER_TPL, TITLE_CLASS, RIBBON_CONTAINER_CLASS, RIBBON_TPL } from './constants';\nimport { Component } from '../../core/component';\nimport { clearDom } from '../../utils/dom';\n\nvar ContinueLegend =\n/** @class */\nfunction (_super) {\n  __extends(ContinueLegend, _super);\n\n  function ContinueLegend() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\n   * 获取默认配置\n   */\n\n\n  ContinueLegend.prototype.getDefaultOptions = function () {\n    return deepMix({}, _super.prototype.getDefaultOptions.call(this), {\n      id: 'l7plot-continue-legend',\n      name: 'l7plot-continue-legend',\n      title: '',\n      containerTpl: CONTAINER_TPL,\n      ribbonTpl: RIBBON_TPL,\n      domStyles: DomStyles,\n      className: CONTAINER_CLASS\n    });\n  };\n  /**\n   * 初始化 container\n   */\n\n\n  ContinueLegend.prototype.initContainer = function () {\n    var customContent = this.options.customContent;\n\n    if (customContent) {\n      var container = this.getHtmlContentNode(customContent);\n      var parentContainer = this.getParentContainer();\n\n      if (parentContainer) {\n        parentContainer.appendChild(container);\n      }\n\n      return container;\n    } else {\n      return _super.prototype.initContainer.call(this);\n    }\n  };\n  /**\n   * 初始化 DOM\n   */\n\n\n  ContinueLegend.prototype.initDom = function () {\n    this.cacheDoms();\n  };\n  /**\n   * 初始化事件\n   */\n\n\n  ContinueLegend.prototype.initEvent = function () {//\n  };\n  /**\n   * 清理事件\n   */\n\n\n  ContinueLegend.prototype.removeEvent = function () {//\n  };\n  /**\n   * 缓存 DOM\n   */\n\n\n  ContinueLegend.prototype.cacheDoms = function () {\n    var container = this.container;\n    var titleDom = container.getElementsByClassName(TITLE_CLASS)[0];\n    var ribbonContainerDom = container.getElementsByClassName(RIBBON_CONTAINER_CLASS)[0];\n    this.titleDom = titleDom;\n    this.ribbonContainerDom = ribbonContainerDom;\n  };\n  /**\n   * 绘制组件\n   */\n\n\n  ContinueLegend.prototype.render = function () {\n    if (this.options.customContent) {\n      this.renderCustomContent(this.options.customContent);\n    } else {\n      this.resetTitle();\n      this.renderRibbon();\n    }\n  };\n  /**\n   * 显示\n   */\n\n\n  ContinueLegend.prototype.show = function () {\n    var container = this.container;\n    if (!container || this.destroyed) return;\n    modifyCSS(container, {\n      visibility: 'visible'\n    });\n  };\n  /**\n   * 隐藏\n   */\n\n\n  ContinueLegend.prototype.hide = function () {\n    var container = this.container;\n    if (!container || this.destroyed) return;\n    modifyCSS(container, {\n      visibility: 'hidden'\n    });\n  };\n  /**\n   * 更新\n   */\n\n\n  ContinueLegend.prototype.updateInner = function (options) {\n    if (this.options.customContent) {\n      this.renderCustomContent(this.options.customContent);\n    } else {\n      if (options.title) {\n        this.resetTitle();\n      }\n\n      if (options.colors) {\n        this.renderRibbon();\n      }\n    }\n\n    _super.prototype.updateInner.call(this, options);\n  };\n  /**\n   * 根据 customContent 渲染 DOM\n   */\n\n\n  ContinueLegend.prototype.renderCustomContent = function (customContent) {\n    var parentContainer = this.container.parentNode;\n    var node = this.getHtmlContentNode(customContent);\n    var curContainer = this.container;\n\n    if (parentContainer) {\n      parentContainer.replaceChild(node, curContainer);\n    }\n\n    this.container = node;\n    this.applyStyles();\n  };\n  /**\n   * 生成自定义内容 DOM\n   */\n\n\n  ContinueLegend.prototype.getHtmlContentNode = function (customContent) {\n    var node;\n    var element = customContent(this.options.title || '', this.options.min, this.options.max, this.options.colors);\n\n    if (isString(element)) {\n      node = this.createDom(element);\n    } else {\n      node = element;\n    }\n\n    return node;\n  };\n  /**\n   * 重置 title\n   */\n\n\n  ContinueLegend.prototype.resetTitle = function () {\n    var title = this.options.title;\n\n    if (title) {\n      this.showTitle();\n      this.setTitle(title);\n    } else {\n      this.hideTitle();\n    }\n  };\n  /**\n   * 显示 title\n   */\n\n\n  ContinueLegend.prototype.showTitle = function () {\n    var titleDom = this.titleDom;\n\n    if (titleDom) {\n      modifyCSS(titleDom, {\n        display: 'block'\n      });\n    }\n  };\n  /**\n   * 隐藏 title\n   */\n\n\n  ContinueLegend.prototype.hideTitle = function () {\n    var titleDom = this.titleDom;\n\n    if (titleDom) {\n      modifyCSS(titleDom, {\n        display: 'none'\n      });\n    }\n  };\n  /**\n   * 设置 title 内容\n   */\n\n\n  ContinueLegend.prototype.setTitle = function (content) {\n    var titleDom = this.titleDom;\n\n    if (titleDom) {\n      titleDom.innerHTML = content;\n    }\n  };\n  /**\n   * 渲染色带\n   */\n\n\n  ContinueLegend.prototype.renderRibbon = function () {\n    this.clearRibbonContainerDoms();\n    var _a = this.options,\n        min = _a.min,\n        max = _a.max,\n        colors = _a.colors,\n        _b = _a.ribbonTpl,\n        ribbonTpl = _b === void 0 ? RIBBON_TPL : _b;\n    var ribbonContainerDom = this.ribbonContainerDom;\n\n    if (ribbonContainerDom) {\n      var backgroundImage = \"linear-gradient(to right, \".concat(colors.join(', '), \")\");\n      var substituteObj = {\n        min: min,\n        max: max,\n        backgroundImage: backgroundImage\n      };\n      var domStr = substitute(ribbonTpl, substituteObj);\n      var dom = this.createDom(domStr);\n      ribbonContainerDom.appendChild(dom);\n      this.applyChildrenStyles(ribbonContainerDom, this.options.domStyles);\n    }\n  };\n  /**\n   * 清空色带 DOM 下的 DOM 元素\n   */\n\n\n  ContinueLegend.prototype.clearRibbonContainerDoms = function () {\n    if (this.ribbonContainerDom) {\n      clearDom(this.ribbonContainerDom);\n    }\n  };\n  /**\n   * 清空所有\n   */\n\n\n  ContinueLegend.prototype.clear = function () {\n    this.setTitle('');\n    this.clearRibbonContainerDoms();\n  };\n\n  return ContinueLegend;\n}(Component);\n\nexport { ContinueLegend };","map":null,"metadata":{},"sourceType":"module"}