{"ast":null,"code":"import { debounce } from './util';\nexport function createSensor(element) {\n  let sensor = null;\n  let listeners = [];\n\n  const create = () => {\n    if (getComputedStyle(element).position === 'static') {\n      const style = element.style;\n      style.position = 'relative';\n    }\n\n    const obj = document.createElement('object');\n\n    obj.onload = () => {\n      obj.contentDocument.defaultView.addEventListener('resize', trigger);\n      trigger();\n    };\n\n    obj.style.display = 'block';\n    obj.style.position = 'absolute';\n    obj.style.top = '0';\n    obj.style.left = '0';\n    obj.style.height = '100%';\n    obj.style.width = '100%';\n    obj.style.overflow = 'hidden';\n    obj.style.pointerEvents = 'none';\n    obj.style.zIndex = '-1';\n    obj.style.opacity = '0';\n    obj.setAttribute('tabindex', '-1');\n    obj.type = 'text/html';\n    element.appendChild(obj); // for ie, should set data attribute delay, or will be white screen\n\n    obj.data = 'about:blank';\n    return obj;\n  };\n\n  const trigger = debounce(() => {\n    listeners.forEach(listener => listener(element));\n  });\n\n  const bind = listener => {\n    if (!sensor) {\n      sensor = create();\n    }\n\n    if (listeners.indexOf(listener) === -1) {\n      listeners.push(listener);\n    }\n  };\n\n  const destroy = () => {\n    if (sensor && sensor.parentNode) {\n      if (sensor.contentDocument) {\n        sensor.contentDocument.defaultView.removeEventListener('resize', trigger);\n      }\n\n      sensor.parentNode.removeChild(sensor);\n      sensor = null;\n      listeners = [];\n    }\n  };\n\n  const unbind = listener => {\n    const idx = listeners.indexOf(listener);\n\n    if (idx !== -1) {\n      listeners.splice(idx, 1);\n    } // no listener, and sensor is exist then destroy the sensor\n\n\n    if (listeners.length === 0 && sensor) {\n      destroy();\n    }\n  };\n\n  return {\n    element,\n    bind,\n    destroy,\n    unbind\n  };\n}","map":null,"metadata":{},"sourceType":"module"}