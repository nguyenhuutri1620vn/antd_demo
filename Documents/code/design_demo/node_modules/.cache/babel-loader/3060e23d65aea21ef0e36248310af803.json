{"ast":null,"code":"import util from '../util';\nimport { alignCoordinates, balance, findSmallestWidthAlignment, findType1Conflicts, findType2Conflicts, horizontalCompaction, verticalAlignment } from './bk';\n\nconst positionY = g => {\n  const layering = util.buildLayerMatrix(g);\n  const rankSep = g.graph().ranksep;\n  let prevY = 0;\n  layering === null || layering === void 0 ? void 0 : layering.forEach(layer => {\n    const heights = layer.map(v => g.node(v).height);\n    const maxHeight = Math.max(...heights);\n    layer === null || layer === void 0 ? void 0 : layer.forEach(v => {\n      g.node(v).y = prevY + maxHeight / 2;\n    });\n    prevY += maxHeight + rankSep;\n  });\n};\n\nconst positionX = g => {\n  const layering = util.buildLayerMatrix(g);\n  const conflicts = Object.assign(findType1Conflicts(g, layering), findType2Conflicts(g, layering));\n  const xss = {};\n  let adjustedLayering;\n  [\"u\", \"d\"].forEach(vert => {\n    // @ts-ignore\n    adjustedLayering = vert === \"u\" ? layering : Object.values(layering).reverse();\n    [\"l\", \"r\"].forEach(horiz => {\n      if (horiz === \"r\") {\n        // @ts-ignore\n        adjustedLayering = adjustedLayering.map(inner => Object.values(inner).reverse());\n      }\n\n      const neighborFn = (vert === \"u\" ? g.predecessors : g.successors).bind(g);\n      const align = verticalAlignment(g, adjustedLayering, conflicts, neighborFn);\n      const xs = horizontalCompaction(g, adjustedLayering, align.root, align.align, horiz === \"r\");\n\n      if (horiz === \"r\") {\n        Object.keys(xs).forEach(xsKey => xs[xsKey] = -xs[xsKey]);\n      }\n\n      xss[vert + horiz] = xs;\n    });\n  });\n  const smallestWidth = findSmallestWidthAlignment(g, xss);\n  smallestWidth && alignCoordinates(xss, smallestWidth);\n  return balance(xss, g.graph().align);\n};\n\nconst position = g => {\n  var _a; // tslint:disable-next-line\n\n\n  g = util.asNonCompoundGraph(g);\n  positionY(g);\n  const xs = positionX(g);\n  (_a = Object.keys(xs)) === null || _a === void 0 ? void 0 : _a.forEach(key => {\n    g.node(key).x = xs[key];\n  });\n};\n\nexport default position;","map":null,"metadata":{},"sourceType":"module"}