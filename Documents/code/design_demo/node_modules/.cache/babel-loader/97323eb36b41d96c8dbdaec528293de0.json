{"ast":null,"code":"'use strict';\n\n(function (m, p) {\n  \"object\" === typeof exports && \"undefined\" !== typeof module ? module.exports = p() : \"function\" === typeof define && define.amd ? define(p) : (m = m || self, m.AMapLoader = p());\n})(this, function () {\n  function m(a) {\n    var b = [];\n    a.AMapUI && b.push(p(a.AMapUI));\n    a.Loca && b.push(r(a.Loca));\n    return Promise.all(b);\n  }\n\n  function p(a) {\n    return new Promise(function (h, c) {\n      var e = [];\n      if (a.plugins) for (var f = 0; f < a.plugins.length; f += 1) -1 == d.AMapUI.plugins.indexOf(a.plugins[f]) && e.push(a.plugins[f]);\n      if (g.AMapUI === b.failed) c(\"\\u524d\\u6b21\\u8bf7\\u6c42 AMapUI \\u5931\\u8d25\");else if (g.AMapUI === b.notload) {\n        g.AMapUI = b.loading;\n        d.AMapUI.version = a.version || d.AMapUI.version;\n        f = d.AMapUI.version;\n        var l = document.body || document.head,\n            k = document.createElement(\"script\");\n        k.type = \"text/javascript\";\n        k.src = \"https://webapi.amap.com/ui/\" + f + \"/main.js\";\n\n        k.onerror = function (a) {\n          g.AMapUI = b.failed;\n          c(\"\\u8bf7\\u6c42 AMapUI \\u5931\\u8d25\");\n        };\n\n        k.onload = function () {\n          g.AMapUI = b.loaded;\n          if (e.length) window.AMapUI.loadUI(e, function () {\n            for (var a = 0, b = e.length; a < b; a++) {\n              var c = e[a].split(\"/\").slice(-1)[0];\n              window.AMapUI[c] = arguments[a];\n            }\n\n            for (h(); n.AMapUI.length;) n.AMapUI.splice(0, 1)[0]();\n          });else for (h(); n.AMapUI.length;) n.AMapUI.splice(0, 1)[0]();\n        };\n\n        l.appendChild(k);\n      } else g.AMapUI === b.loaded ? a.version && a.version !== d.AMapUI.version ? c(\"\\u4e0d\\u5141\\u8bb8\\u591a\\u4e2a\\u7248\\u672c AMapUI \\u6df7\\u7528\") : e.length ? window.AMapUI.loadUI(e, function () {\n        for (var a = 0, b = e.length; a < b; a++) {\n          var c = e[a].split(\"/\").slice(-1)[0];\n          window.AMapUI[c] = arguments[a];\n        }\n\n        h();\n      }) : h() : a.version && a.version !== d.AMapUI.version ? c(\"\\u4e0d\\u5141\\u8bb8\\u591a\\u4e2a\\u7248\\u672c AMapUI \\u6df7\\u7528\") : n.AMapUI.push(function (a) {\n        a ? c(a) : e.length ? window.AMapUI.loadUI(e, function () {\n          for (var a = 0, b = e.length; a < b; a++) {\n            var c = e[a].split(\"/\").slice(-1)[0];\n            window.AMapUI[c] = arguments[a];\n          }\n\n          h();\n        }) : h();\n      });\n    });\n  }\n\n  function r(a) {\n    return new Promise(function (h, c) {\n      if (d.AMap.version.startsWith(\"2.0\")) c(\"Loca \\u6682\\u4e0d\\u9002\\u914d JSAPI 2.0,\\u8bf7\\u4f7f\\u7528 1.4.15\");else if (g.Loca === b.failed) c(\"\\u524d\\u6b21\\u8bf7\\u6c42 Loca \\u5931\\u8d25\");else if (g.Loca === b.notload) {\n        g.Loca = b.loading;\n        d.Loca.version = a.version || d.Loca.version;\n        var e = d.Loca.version,\n            f = d.key,\n            l = document.body || document.head,\n            k = document.createElement(\"script\");\n        k.type = \"text/javascript\";\n        k.src = \"https://webapi.amap.com/loca?v=\" + e + \"&key=\" + f;\n\n        k.onerror = function (a) {\n          g.Loca = b.failed;\n          c(\"\\u8bf7\\u6c42 AMapUI \\u5931\\u8d25\");\n        };\n\n        k.onload = function () {\n          g.Loca = b.loaded;\n\n          for (h(); n.Loca.length;) n.Loca.splice(0, 1)[0]();\n        };\n\n        l.appendChild(k);\n      } else g.Loca === b.loaded ? a.version && a.version !== d.Loca.version ? c(\"\\u4e0d\\u5141\\u8bb8\\u591a\\u4e2a\\u7248\\u672c Loca \\u6df7\\u7528\") : h() : a.version && a.version !== d.Loca.version ? c(\"\\u4e0d\\u5141\\u8bb8\\u591a\\u4e2a\\u7248\\u672c Loca \\u6df7\\u7528\") : n.Loca.push(function (a) {\n        a ? c(a) : c();\n      });\n    });\n  }\n\n  if (!window) throw Error(\"AMap JSAPI can only be used in Browser.\");\n  var b;\n\n  (function (a) {\n    a.notload = \"notload\";\n    a.loading = \"loading\";\n    a.loaded = \"loaded\";\n    a.failed = \"failed\";\n  })(b || (b = {}));\n\n  var d = {\n    key: \"\",\n    AMap: {\n      version: \"1.4.15\",\n      plugins: []\n    },\n    AMapUI: {\n      version: \"1.1\",\n      plugins: []\n    },\n    Loca: {\n      version: \"1.3.2\"\n    }\n  },\n      g = {\n    AMap: b.notload,\n    AMapUI: b.notload,\n    Loca: b.notload\n  },\n      n = {\n    AMap: [],\n    AMapUI: [],\n    Loca: []\n  },\n      q = [],\n      t = function (a) {\n    \"function\" == typeof a && (g.AMap === b.loaded ? a(window.AMap) : q.push(a));\n  };\n\n  return {\n    load: function (a) {\n      return new Promise(function (h, c) {\n        if (g.AMap == b.failed) c(\"\");else if (g.AMap == b.notload) {\n          var e = a.key,\n              f = a.version,\n              l = a.plugins;\n          e ? (window.AMap && \"lbs.amap.com\" !== location.host && c(\"\\u7981\\u6b62\\u591a\\u79cdAPI\\u52a0\\u8f7d\\u65b9\\u5f0f\\u6df7\\u7528\"), d.key = e, d.AMap.version = f || d.AMap.version, d.AMap.plugins = l || d.AMap.plugins, g.AMap = b.loading, f = document.body || document.head, window.___onAPILoaded = function (d) {\n            delete window.___onAPILoaded;\n            if (d) g.AMap = b.failed, c(d);else for (g.AMap = b.loaded, m(a).then(function () {\n              h(window.AMap);\n            })[\"catch\"](c); q.length;) q.splice(0, 1)[0]();\n          }, l = document.createElement(\"script\"), l.type = \"text/javascript\", l.src = \"https://webapi.amap.com/maps?callback=___onAPILoaded&v=\" + d.AMap.version + \"&key=\" + e + \"&plugin=\" + d.AMap.plugins.join(\",\"), l.onerror = function (a) {\n            g.AMap = b.failed;\n            c(a);\n          }, f.appendChild(l)) : c(\"\\u8bf7\\u586b\\u5199key\");\n        } else if (g.AMap == b.loaded) {\n          if (a.key && a.key !== d.key) c(\"\\u591a\\u4e2a\\u4e0d\\u4e00\\u81f4\\u7684 key\");else if (a.version && a.version !== d.AMap.version) c(\"\\u4e0d\\u5141\\u8bb8\\u591a\\u4e2a\\u7248\\u672c JSAPI \\u6df7\\u7528\");else {\n            e = [];\n            if (a.plugins) for (f = 0; f < a.plugins.length; f += 1) -1 == d.AMap.plugins.indexOf(a.plugins[f]) && e.push(a.plugins[f]);\n            if (e.length) window.AMap.plugin(e, function () {\n              m(a).then(function () {\n                h(window.AMap);\n              })[\"catch\"](c);\n            });else m(a).then(function () {\n              h(window.AMap);\n            })[\"catch\"](c);\n          }\n        } else if (a.key && a.key !== d.key) c(\"\\u591a\\u4e2a\\u4e0d\\u4e00\\u81f4\\u7684 key\");else if (a.version && a.version !== d.AMap.version) c(\"\\u4e0d\\u5141\\u8bb8\\u591a\\u4e2a\\u7248\\u672c JSAPI \\u6df7\\u7528\");else {\n          var k = [];\n          if (a.plugins) for (f = 0; f < a.plugins.length; f += 1) -1 == d.AMap.plugins.indexOf(a.plugins[f]) && k.push(a.plugins[f]);\n          t(function () {\n            if (k.length) window.AMap.plugin(k, function () {\n              m(a).then(function () {\n                h(window.AMap);\n              })[\"catch\"](c);\n            });else m(a).then(function () {\n              h(window.AMap);\n            })[\"catch\"](c);\n          });\n        }\n      });\n    },\n    reset: function () {\n      delete window.AMap;\n      delete window.AMapUI;\n      delete window.Loca;\n      d = {\n        key: \"\",\n        AMap: {\n          version: \"1.4.15\",\n          plugins: []\n        },\n        AMapUI: {\n          version: \"1.1\",\n          plugins: []\n        },\n        Loca: {\n          version: \"1.3.2\"\n        }\n      };\n      g = {\n        AMap: b.notload,\n        AMapUI: b.notload,\n        Loca: b.notload\n      };\n      n = {\n        AMap: [],\n        AMapUI: [],\n        Loca: []\n      };\n    }\n  };\n});","map":null,"metadata":{},"sourceType":"script"}