{"ast":null,"code":"import { bbox } from './bbox';\nimport { offset, getStrokeWidth } from './util';\nimport { FunctionExt } from '../../util';\n/**\n * Places the connection point at the intersection between the\n * link path end segment and the element's unrotated bbox.\n */\n\nexport const rect = function (line, view, magnet, options, type) {\n  const cell = view.cell;\n  const angle = cell.isNode() ? cell.getAngle() : 0;\n\n  if (angle === 0) {\n    return FunctionExt.call(bbox, this, line, view, magnet, options, type);\n  }\n\n  const bboxRaw = view.getUnrotatedBBoxOfElement(magnet);\n\n  if (options.stroked) {\n    bboxRaw.inflate(getStrokeWidth(magnet) / 2);\n  }\n\n  const center = bboxRaw.getCenter();\n  const lineRaw = line.clone().rotate(angle, center);\n  const intersections = lineRaw.setLength(1e6).intersect(bboxRaw);\n  const p = intersections && intersections.length ? lineRaw.start.closest(intersections).rotate(-angle, center) : line.end;\n  return offset(p, line.start, options.offset);\n};","map":null,"metadata":{},"sourceType":"module"}