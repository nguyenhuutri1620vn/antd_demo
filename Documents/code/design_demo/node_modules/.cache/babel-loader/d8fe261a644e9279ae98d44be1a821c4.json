{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport { gl } from '@antv/g-webgpu-core';\nimport * as WebGPUConstants from '@webgpu/types/dist/constants';\nimport { filterMap, formatMap, wrapModeMap } from './constants';\n/**\n * adaptor for regl.Buffer\n * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#buffers\n */\n\nvar WebGPUTexture2D = /*#__PURE__*/function () {\n  function WebGPUTexture2D(engine, options) {\n    _classCallCheck(this, WebGPUTexture2D);\n\n    this.engine = engine;\n    this.options = options;\n    this.texture = void 0;\n    this.sampler = void 0;\n    this.width = void 0;\n    this.height = void 0;\n    this.createTexture();\n  }\n\n  _createClass(WebGPUTexture2D, [{\n    key: \"get\",\n    value: function get() {\n      return {\n        texture: this.texture,\n        sampler: this.sampler\n      };\n    }\n  }, {\n    key: \"update\",\n    value: function update() {// TODO\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(_ref) {\n      var width = _ref.width,\n          height = _ref.height; // TODO: it seems that Texture doesn't support `resize`\n\n      if (width !== this.width || height !== this.height) {\n        this.destroy();\n        this.createTexture();\n      }\n\n      this.width = width;\n      this.height = height;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      if (this.texture) {\n        this.texture.destroy();\n      }\n    }\n  }, {\n    key: \"createTexture\",\n    value: function createTexture() {\n      var _this$options = this.options,\n          data = _this$options.data,\n          _this$options$type = _this$options.type,\n          type = _this$options$type === void 0 ? gl.UNSIGNED_BYTE : _this$options$type,\n          width = _this$options.width,\n          height = _this$options.height,\n          _this$options$flipY = _this$options.flipY,\n          flipY = _this$options$flipY === void 0 ? false : _this$options$flipY,\n          _this$options$format = _this$options.format,\n          format = _this$options$format === void 0 ? gl.RGBA : _this$options$format,\n          _this$options$mipmap = _this$options.mipmap,\n          mipmap = _this$options$mipmap === void 0 ? false : _this$options$mipmap,\n          _this$options$wrapS = _this$options.wrapS,\n          wrapS = _this$options$wrapS === void 0 ? gl.CLAMP_TO_EDGE : _this$options$wrapS,\n          _this$options$wrapT = _this$options.wrapT,\n          wrapT = _this$options$wrapT === void 0 ? gl.CLAMP_TO_EDGE : _this$options$wrapT,\n          _this$options$aniso = _this$options.aniso,\n          aniso = _this$options$aniso === void 0 ? 0 : _this$options$aniso,\n          _this$options$alignme = _this$options.alignment,\n          alignment = _this$options$alignme === void 0 ? 1 : _this$options$alignme,\n          _this$options$premult = _this$options.premultiplyAlpha,\n          premultiplyAlpha = _this$options$premult === void 0 ? false : _this$options$premult,\n          _this$options$mag = _this$options.mag,\n          mag = _this$options$mag === void 0 ? gl.NEAREST : _this$options$mag,\n          _this$options$min = _this$options.min,\n          min = _this$options$min === void 0 ? gl.NEAREST : _this$options$min,\n          _this$options$colorSp = _this$options.colorSpace,\n          colorSpace = _this$options$colorSp === void 0 ? gl.BROWSER_DEFAULT_WEBGL : _this$options$colorSp,\n          usage = _this$options.usage;\n      this.width = width;\n      this.height = height;\n      this.texture = this.engine.device.createTexture({\n        size: [width, height, 1],\n        // TODO: arrayLayerCount is deprecated: use size.depth\n        // arrayLayerCount: 1,\n        mipLevelCount: 1,\n        // TODO: https://gpuweb.github.io/gpuweb/#dom-gputextureviewdescriptor-miplevelcount\n        sampleCount: 1,\n        dimension: WebGPUConstants.TextureDimension.E2d,\n        format: formatMap[format],\n        // could throw texture binding usage mismatch\n        usage: usage || WebGPUConstants.TextureUsage.Sampled | WebGPUConstants.TextureUsage.CopyDst\n      });\n\n      if (!usage || usage & WebGPUConstants.TextureUsage.Sampled) {\n        this.sampler = this.engine.device.createSampler({\n          addressModeU: wrapModeMap[wrapS],\n          addressModeV: wrapModeMap[wrapT],\n          addressModeW: wrapModeMap[wrapS],\n          // TODO: same as addressModeU\n          magFilter: filterMap[mag],\n          minFilter: filterMap[min],\n          maxAnisotropy: aniso // @see https://gpuweb.github.io/gpuweb/#dom-gpusamplerdescriptor-maxanisotropy\n\n        });\n      }\n    }\n  }]);\n\n  return WebGPUTexture2D;\n}();\n\nexport { WebGPUTexture2D as default };","map":null,"metadata":{},"sourceType":"module"}