{"ast":null,"code":"import { __spreadArray } from \"tslib\";\nimport { isString } from '@antv/util';\nimport { traverseTree } from './graphic';\n/**\n * 验证关系图或树图数据的合法性，必须符合以下规则才会渲染图：\n * 1. 必须传入数据\n * 2. 节点的 ID 必须为字符串，暂不支持数字类型，如果支持数字类型，会出现类似 123 与 '123' 是否相等的问题\n * 3. 边的 source 和 target 值必须在节点 ID 中存在\n * @param data 关系图或树图数据\n * @return boolean 全部验证通过返回 true，否则返回 false\n */\n\nexport var dataValidation = function dataValidation(data) {\n  var _a; // 1. 必须传入数据\n\n\n  if (!data) {\n    console.error('G6 Error Tips: the data must be defined');\n    return false;\n  } // 2. 节点的 ID 必须为字符串或数字类型\n\n\n  var nodes = data.nodes,\n      edges = data.edges,\n      _b = data.combos,\n      combos = _b === void 0 ? [] : _b;\n\n  if (!nodes && !edges) {\n    var validated_1 = true; // 不存在 nodes 和 edges，则说明是 TreeGraphData，按 TreeGraphData 规则验证\n\n    traverseTree(data, function (param) {\n      if (!isString(param.id)) {\n        validated_1 = false;\n        return false;\n      }\n\n      return true;\n    });\n    return validated_1;\n  }\n\n  var nonNode = (nodes || []).find(function (node) {\n    return !isString(node.id);\n  });\n\n  if (nonNode) {\n    console.warn(\"G6 Warning Tips: missing 'id' property, or %c\".concat(nonNode.id, \"%c is not a string.\"), 'font-size: 20px; color: red;', '');\n    return false;\n  } // 3. 边的 source 和 target 必须存在于节点 或 Combo中\n\n\n  var nodeIds = (nodes || []).map(function (node) {\n    return node.id;\n  });\n  var comboIds = (_a = combos) === null || _a === void 0 ? void 0 : _a.map(function (combo) {\n    return combo.id;\n  });\n\n  var ids = __spreadArray(__spreadArray([], nodeIds, true), comboIds, true);\n\n  var nonEdges = (edges || []).find(function (edge) {\n    return !ids.includes(edge.source) || !ids.includes(edge.target);\n  });\n\n  if (nonEdges) {\n    console.warn(\"G6 Warning Tips: The source %c\".concat(nonEdges.source, \"%c or the target %c\").concat(nonEdges.target, \"%c of the edge do not exist in the nodes or combos.\"), 'font-size: 20px; color: red;', '', 'font-size: 20px; color: red;', '');\n    return false;\n  }\n\n  return true;\n};\n/**\n * 验证添加节点、边或从combo时的数据\n * @param type 节点、边或从combo\n * @param data 添加的单条数据\n * @return boolean 全部验证通过返回 true，否则返回 false\n */\n\nexport var singleDataValidation = function singleDataValidation(type, data) {\n  if (type === 'node' || type === 'combo') {\n    // 必须有 id 字段，且id必须为字符串类型\n    if (data.id && !isString(data.id)) {\n      console.warn(\"G6 Warning Tips: missing 'id' property, or the 'id' %c\".concat(data.id, \"%c is not a string.\"), 'font-size: 20px; color: red;', '');\n      return false;\n    }\n  } else if (type === 'edge') {\n    // 必须有 source 和 target 字段\n    if (!data.source || !data.target) {\n      console.warn(\"G6 Warning Tips: missing 'source' or 'target' for the edge.\");\n      return false;\n    }\n  }\n\n  return true;\n};","map":null,"metadata":{},"sourceType":"module"}