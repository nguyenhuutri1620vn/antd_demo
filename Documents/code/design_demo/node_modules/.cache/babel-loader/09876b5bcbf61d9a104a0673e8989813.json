{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { modifyCSS, createDom } from '@antv/dom-util';\nimport Base from '../base'; // 网格背景图片\n\nvar GRID_PNG = 'url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)';\n\nvar Grid =\n/** @class */\nfunction (_super) {\n  __extends(Grid, _super);\n\n  function Grid(config) {\n    return _super.call(this, config) || this;\n  }\n\n  Grid.prototype.getDefaultCfgs = function () {\n    return {\n      img: GRID_PNG,\n      follow: true\n    };\n  };\n\n  Grid.prototype.init = function () {\n    var graph = this.get('graph');\n    var graphContainer = graph.get('container');\n    var canvas = graph.get('canvas').get('el');\n    var img = this.get('img') || GRID_PNG;\n    var container = createDom(\"<div class='g6-grid-container' style=\\\"position:absolute;overflow:hidden;z-index: -1;\\\"></div>\");\n    var gridContainer = createDom(\"<div\\n        class='g6-grid'\\n        style='position:absolute;\\n        background-image: \".concat(img, \";\\n        user-select: none\\n        '></div>\"));\n    this.set('container', container);\n    this.set('gridContainer', gridContainer);\n    this.positionInit();\n    container.appendChild(gridContainer);\n    graphContainer.insertBefore(container, canvas);\n  };\n  /** 定位信息初始化 */\n\n\n  Grid.prototype.positionInit = function () {\n    var graph = this.get('graph');\n    var minZoom = graph.get('minZoom');\n    var width = graph.get('width');\n    var height = graph.get('height');\n    modifyCSS(this.get('container'), {\n      width: \"\".concat(width, \"px\"),\n      height: \"\".concat(height, \"px\")\n    }); // 网格 40*40 需保证 (gridContainerWidth / 2) % 40 = 0 才能让网格线对齐左上角 故 * 80\n\n    var gridContainerWidth = width * 80 / minZoom;\n    var gridContainerHeight = height * 80 / minZoom;\n    modifyCSS(this.get('gridContainer'), {\n      width: \"\".concat(gridContainerWidth, \"px\"),\n      height: \"\".concat(gridContainerHeight, \"px\"),\n      left: \"-\".concat(gridContainerWidth / 2, \"px\"),\n      top: \"-\".concat(gridContainerHeight / 2, \"px\")\n    });\n  }; // class-methods-use-this\n\n\n  Grid.prototype.getEvents = function () {\n    return {\n      viewportchange: 'updateGrid'\n    };\n  };\n  /**\n   * viewport change 事件的响应函数\n   * @param param\n   */\n\n\n  Grid.prototype.updateGrid = function (param) {\n    var gridContainer = this.get('gridContainer');\n    var matrix = param.matrix;\n    if (!matrix) matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var isFollow = this.get('follow');\n    var transform = \"matrix(\".concat(matrix[0], \", \").concat(matrix[1], \", \").concat(matrix[3], \", \").concat(matrix[4], \", \").concat(isFollow ? matrix[6] : '0', \", \").concat(isFollow ? matrix[7] : '0', \")\");\n    modifyCSS(gridContainer, {\n      transform: transform\n    });\n  };\n\n  Grid.prototype.getContainer = function () {\n    return this.get('container');\n  };\n\n  Grid.prototype.destroy = function () {\n    var graph = this.get('graph');\n    var graphContainer = graph.get('container');\n    var container = this.get('container');\n    graphContainer.removeChild(container);\n  };\n\n  return Grid;\n}(Base);\n\nexport default Grid;","map":null,"metadata":{},"sourceType":"module"}